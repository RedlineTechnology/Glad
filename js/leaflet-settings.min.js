jQuery((function(e){var a=themevars.template_directory,n=themevars.userid,o=themevars.locations,t=null,i=null;console.log(o);var r=L.map("membermap").setView([41,-38],3);L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"sk.eyJ1IjoiamFzb25zdWJlcnMiLCJhIjoiY2tlaW43OXU3MGxjbjJ6cGh4M21rdWR0ZiJ9.oV_Z2tiuL8vXqZucCG4kOg"}).addTo(r),e.each(o,(function(a,o){var t=o.id,s=o.name,m=o.link,d=o.company,l=o.logo,c=JSON.parse(o.locations);e.each(c,(function(e,a){var o=a.name,c=a.latlng;if(""!=c){var u="";n==t&&(u='<form action="#" method="POST" class="deletenode" enctype="multipart/form-data"><input type="hidden" name="action" value="deletenode"><input type="hidden" name="user_id" value="'+n+'"><input type="hidden" name="node" value=\''+JSON.stringify(c)+'\'><button class="deletenode nostyle" value="deletenode">Remove</button></form>'),p=L.popup(),i=L.marker(c).addTo(r),p.setLatLng(c).setContent('<div class="logo"><img src="'+l+'"></div><div class="info"><span><a href="'+m+'">'+s+"</a></span><br><span>"+d+"</span><br><span>"+o+"</span><br>\x3c!--<span>"+c.lat+", "+c.lng+"</span>--\x3e"+u+"</div>"),i.bindPopup(p)}}))}));L.Control.geocoder({defaultMarkGeocode:!1}).on("markgeocode",(function(e){var n=e.geocode.center,o=e.geocode.name,t=L.icon({iconUrl:a+"/vendor/leaflet/images/marker-icon-green.png",iconRetinaUrl:a+"/vendor/leaflet/images/marker-icon-green-2x.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowUrl:a+"/vendor/leaflet/images/marker-shadow.png",shadowSize:[41,41]});L.marker(n,{title:o,icon:t}).addTo(r).on("mouseover",s);r.panTo(n)})).addTo(r);function s(a){var o=L.popup(),i=this.options.title,s=this.getLatLng();o.setLatLng(s).setContent('<div class="info"><span>'+i+"</span><br><span>"+s.lat+", "+s.lng+'</span><br><form action="#" method="POST" class="membermap-form" id="membermap-form" enctype="multipart/form-data"><input type="hidden" name="action" value="savelocation"><input type="hidden" name="user_id" value="'+n+'"><input type="hidden" name="loc_name" value="'+i+'"><input type="hidden" name="latlng" value=\''+JSON.stringify(s)+'\'><button id="membermap-submit" value="savelocation">Save to My Locations</button></form></div>'),this.bindPopup(o).openPopup(),e(".membermap-form").submit((function(){return e.ajax({url:"https://www.glada.aero/wp-admin/admin-ajax.php",type:"POST",data:e(this).find(":input").filter((function(a,n){return""!=e(n).val()})).serialize(),dataType:"json",beforeSend:function(a){e("#membermap-submit").addClass("loading").text("Saving...")},success:function(a){e("#membermap-submit").removeClass("loading").text("SUCCESS!"),r.removeLayer(t);L.marker(s).addTo(r)}}),!1}))}var p=L.popup();t={};r.on("click",(function(n){null!=t&&r.removeLayer(t),L.Control.Geocoder.nominatim().reverse(n.latlng,r.options.crs.scale(r.getZoom()),(function(e){var n=e[0],o=L.icon({iconUrl:a+"/vendor/leaflet/images/marker-icon-red.png",iconRetinaUrl:a+"/vendor/leaflet/images/marker-icon-red-2x.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowUrl:a+"/vendor/leaflet/images/marker-shadow.png",shadowSize:[41,41]});n&&(t=L.marker(n.center,{title:n.name,icon:o}).addTo(r).on("mouseover",s))})),e(".membermap-form").submit((function(){return e.ajax({url:"https://www.glada.aero/wp-admin/admin-ajax.php",type:"POST",data:e(this).find(":input").filter((function(a,n){return""!=e(n).val()})).serialize(),dataType:"json",beforeSend:function(a){e("#membermap-submit").addClass("loading").text("Saving...")},success:function(a){e("#membermap-submit").removeClass("loading").text("SUCCESS!"),r.removeLayer(t);L.marker(latlng).addTo(r)}}),!1}))})),r.on("popupopen",(function(a){popMarker=a.popup._source,e("form.deletenode").submit((function(){return e.ajax({url:"https://www.glada.aero/wp-admin/admin-ajax.php",type:"POST",data:e(this).find(":input").filter((function(a,n){return""!=e(n).val()})).serialize(),dataType:"json",beforeSend:function(a){e(this).find("button").addClass("loading").text("Removing...")},success:function(a){e(this).find("button").removeClass("loading").text("SUCCESS!"),r.removeLayer(popMarker)}}),!1}))}))}));